# Reddit Explorerテスト

このディレクトリには、Reddit Explorerサービス(`nook/local/services/reddit_explorer.py`)のテストコードが含まれています。

## テストの種類

1. **ユニットテスト**: モックを使用した各メソッドの単体テスト
2. **E2Eテスト**: 実際のReddit APIを使用した統合テスト

## 実行方法

### 前提条件

- Python 3.9以上
- 必要なライブラリがインストールされていること
- プロジェクトルートの`.env`ファイルに必要なAPI認証情報が設定されていること

### ユニットテストの実行

以下のコマンドでユニットテストを実行します：

```bash
./run_test.sh
```

または直接Pythonで実行：

```bash
python3 test_reddit_explorer.py
```

### E2Eテストの実行

以下のコマンドでE2Eテストを実行します：

```bash
./run_e2e_test.sh
```

オプション：

- `-s, --subreddits`: テスト対象のサブレディット（空白区切りで複数指定可能）
- `-l, --limit`: 取得する投稿数（デフォルト: 2）
- `-v, --verbose`: 詳細な出力を表示する

例：

```bash
./run_e2e_test.sh -s Python programming -l 3 -v
```

## テスト内容

### ユニットテスト（`test_reddit_explorer.py`）

- 初期化が正しく行われるかテスト
- 投稿の整形が正しく行われるかテスト
- サマリーの保存が正しく行われるかテスト
- システム指示文の生成が正しく行われるかテスト
- `__call__`メソッドの動作をテスト

### E2Eテスト（`e2e_test.py`）

- 実際のReddit APIを使用して投稿の取得をテスト
- コメントの取得をテスト
- Gemini APIを使用したサマリー生成をテスト
- 完全な処理フローをテスト

## 注意事項

- E2Eテストでは実際のAPIを呼び出すため、APIの利用制限に注意してください。
- デフォルトでは各サブレディットあたり2件の投稿のみを取得します。
- テストに使用する環境変数は、プロジェクトルートの`.env`ファイルから読み込まれます。
